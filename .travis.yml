sudo: false
language: node_js
node_js:
  - "5.3.0"

cache:
  directories:
    - node_modules

env:
  - TASK=lint
  - TASK=validate-manifest
  - TASK=test
  - TASK=build:prod
  - TASK=build:ac
  - TASK=securityscan SECURITYSCAN=srcclr

install:
  - npm set progress=false && npm install
  - ./script/fetch_i18n
  - npm run build-setup:prod

script:
  - |
    if [[ "$SECURITYSCAN" == "srcclr" ]]
    then
        echo "Starting Source clear scan ...";
        ./script/run_sourceclear.sh;
    else
        echo "Running unit or integration tests";
        npm run $TASK;
    fi
branches:
  only:
    - master
    - /^feature.*$/

notifications:
  email: false
  webhooks: https://samson.zende.sk/integrations/travis/b127503546dbc459293e47fbae026af2
  slack:
    secure: pHyAv7xNsAF1mdz9o4joPqvfe2mM9q5ttvN0GqJYWRfQIUlcwvMQnyRZMSrsRRAFh5nqRayXOMuLa/wE1MyqAug5nK5yPEgZQRjLDeXeHXv3vOLlcgcHJcrrqyCGkLRnFP0LDintwpJIIzNkcr+qSJPQ7QjPjZd5Rf0zfvfTQwo=
